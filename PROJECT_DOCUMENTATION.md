# Документация проекта TaskTracker

## 1. Общая информация о проекте

### 1.1 Наименование проекта
**TaskTracker** - Система управления задачами с аутентификацией и авторизацией

### 1.2 Версия проекта
- **Версия**: 0.0.1-SNAPSHOT
- **Дата создания документации**: 24.10.2025
- **Статус**: В разработке

### 1.3 Описание проекта
TaskTracker - это веб-приложение для управления задачами, построенное на Spring Boot. Система предоставляет функциональность для создания, назначения, отслеживания и управления задачами с поддержкой ролевой модели доступа и уведомлений через Apache Kafka.

## 2. Техническая архитектура

### 2.1 Технологический стек

#### 2.1.1 Основные технологии
- **Java**: 17
- **Spring Boot**: 3.5.4
- **Spring Security**: Для аутентификации и авторизации
- **Spring Data JPA**: Для работы с базой данных
- **Spring Kafka**: Для асинхронных уведомлений
- **PostgreSQL**: Основная база данных
- **Apache Kafka**: Система сообщений
- **Docker**: Контейнеризация

#### 2.1.2 Дополнительные библиотеки
- **Lombok**: Для сокращения boilerplate кода
- **Jackson**: Для JSON сериализации/десериализации
- **JWT (JSON Web Tokens)**: Для аутентификации
- **JUnit 5**: Для тестирования
- **Mockito**: Для мокирования в тестах

### 2.2 Архитектурные компоненты

#### 2.2.1 Слой представления (Presentation Layer)
- **Controller**: REST API контроллеры для обработки HTTP запросов
- **JWT Authentication**: Система аутентификации на основе токенов

#### 2.2.2 Бизнес-логика (Business Logic Layer)
- **Service**: Сервисы для бизнес-логики
  - `TaskService`: Управление задачами
  - `UserService`: Управление пользователями
  - `CommentService`: Управление комментариями
  - `CustomUserDetailsService`: Интеграция с Spring Security

#### 2.2.3 Слой данных (Data Access Layer)
- **Repository**: Репозитории для доступа к данным
  - `TaskRepository`: Работа с задачами
  - `UserRepository`: Работа с пользователями
  - `CommentRepository`: Работа с комментариями

#### 2.2.4 Слой сущностей (Entity Layer)
- **Entity**: JPA сущности
  - `Task`: Задача
  - `User`: Пользователь
  - `Comment`: Комментарий
  - `Status`: Статус задачи (enum)
  - `Importance`: Важность задачи (enum)
  - `Role`: Роль пользователя (enum)

#### 2.2.5 Интеграционный слой (Integration Layer)
- **Kafka Integration**: Асинхронные уведомления
- **JWT Integration**: Аутентификация

## 3. Функциональные требования

### 3.1 Управление пользователями
- **Регистрация пользователей**: Создание новых пользователей с ролью USER
- **Регистрация администраторов**: Создание пользователей с ролью ADMIN
- **Аутентификация**: Вход в систему с получением JWT токена
- **Управление пользователями**: Администраторы могут удалять пользователей

### 3.2 Управление задачами
- **Создание задач**: Создание новых задач с назначением исполнителя
- **Обновление задач**: Изменение параметров задач
- **Отслеживание статуса**: Изменение статуса задач
  - НЕ_НАЧАТА
  - В_РАБОТЕ
  - ЗАВЕРШЕНА
  - НА_ДОРАБОТКЕ
- **Управление важностью**: Назначение уровня важности
  - СРОЧНАЯ
  - НАДО_ПОТОРОПИТЬСЯ
  - МОЖЕТ_ПОДОЖДАТЬ

### 3.3 Система комментариев
- **Добавление комментариев**: Возможность добавления комментариев к задачам
- **Комментарии при доработке**: Обязательные комментарии при отправке на доработку

### 3.4 Уведомления
- **Kafka уведомления**: Асинхронные уведомления через Apache Kafka
- **Producer/Consumer**: Система отправки и получения уведомлений

## 4. API Endpoints

### 4.1 Аутентификация
- `POST /register` - Регистрация пользователя
- `POST /registeradmin` - Регистрация администратора
- `POST /login` - Вход в систему

### 4.2 Управление пользователями
- `GET /user` - Получение информации о пользователе
- `GET /allusers` - Получение списка всех пользователей
- `GET /userwithouttasks` - Получение пользователя без задач
- `GET /allusersname` - Получение имен всех пользователей (только для ADMIN)
- `DELETE /deleteuser/{username}` - Удаление пользователя (только для ADMIN)

### 4.3 Управление задачами
- `PUT /markthetaskascompleted` - Отметить задачу как выполненную
- `PUT /markthetaskasinwork` - Отметить задачу как находящуюся в работе
- `PUT /markthetaskasonrework` - Отправить задачу на доработку (только для ADMIN)
- `PUT /updatetask` - Обновить задачу (только для ADMIN)

### 4.4 Общие endpoints
- `GET /main` - Главная страница

## 5. Модель данных

### 5.1 Сущность Task
```java
- id: Long (Primary Key)
- title: String (обязательное)
- description: String
- status: Status (обязательное)
- importance: Importance (обязательное)
- deadline: LocalDateTime
- assignee: User (ManyToOne)
- comments: List<Comment> (OneToMany)
```

### 5.2 Сущность User
```java
- id: Long (Primary Key)
- username: String (уникальное, обязательное)
- password: String (обязательное)
- role: Role (обязательное)
- tasks: List<Task> (OneToMany)
```

### 5.3 Сущность Comment
```java
- id: Long (Primary Key)
- content: String
- task: Task (ManyToOne)
```

## 6. Безопасность

### 6.1 Аутентификация
- **JWT токены**: Stateless аутентификация
- **BCrypt хеширование**: Безопасное хранение паролей
- **Session Management**: STATELESS политика

### 6.2 Авторизация
- **Ролевая модель**: USER и ADMIN роли
- **Method-level security**: @PreAuthorize аннотации
- **Endpoint protection**: Различные уровни доступа

### 6.3 Конфигурация безопасности
- **CSRF**: Отключен для REST API
- **CORS**: Настроен для веб-клиентов
- **JWT Filter**: Кастомный фильтр для обработки токенов

## 7. Интеграции

### 7.1 Apache Kafka
- **Producer**: Отправка уведомлений
- **Consumer**: Обработка уведомлений
- **Topics**: Настраиваемые топики для различных типов уведомлений
- **Docker Compose**: Локальная инфраструктура Kafka

### 7.2 База данных
- **PostgreSQL**: Основная реляционная база данных
- **JPA/Hibernate**: ORM для работы с данными
- **Connection Pooling**: Управление соединениями

## 8. Развертывание

### 8.1 Docker Compose
```yaml
services:
  zookeeper: # Apache Zookeeper для Kafka
  kafka: # Apache Kafka брокер
  kafka-ui: # Веб-интерфейс для Kafka
```

### 8.2 Требования к окружению
- **Java**: 17+
- **Maven**: 3.6+
- **Docker**: 20.10+
- **PostgreSQL**: 13+

### 8.3 Конфигурация
- **Порт приложения**: 8080 (по умолчанию)
- **Порт Kafka**: 9092
- **Порт Kafka UI**: 8081
- **Порт Zookeeper**: 2181

## 9. Тестирование

### 9.1 Типы тестов
- **Unit тесты**: JUnit 5 + Mockito
- **Integration тесты**: Spring Boot Test
- **Security тесты**: Spring Security Test

### 9.2 Покрытие тестами
- **Service layer**: Бизнес-логика
- **Controller layer**: REST endpoints
- **Security layer**: Аутентификация и авторизация

## 10. Мониторинг и логирование

### 10.1 Логирование
- **SLF4J + Logback**: Структурированное логирование
- **Log levels**: INFO, DEBUG, ERROR
- **Request/Response logging**: Отслеживание API вызовов

### 10.2 Мониторинг
- **Kafka UI**: Мониторинг Kafka кластера
- **Application logs**: Логи приложения
- **Health checks**: Проверка состояния сервисов

## 11. Производительность

### 11.1 Оптимизации
- **Connection pooling**: Эффективное использование соединений с БД
- **Lazy loading**: Ленивая загрузка связанных сущностей
- **Stateless architecture**: Масштабируемость

### 11.2 Рекомендации
- **Database indexing**: Индексы для часто используемых полей
- **Kafka partitioning**: Параллельная обработка сообщений
- **Caching**: Кэширование часто запрашиваемых данных

## 12. Безопасность данных

### 12.1 Защита данных
- **Password hashing**: BCrypt с солью
- **JWT security**: Подписанные токены с истечением срока
- **SQL injection protection**: JPA/Hibernate защита

### 12.2 Конфиденциальность
- **Data encryption**: Шифрование чувствительных данных
- **Access control**: Ролевая модель доступа
- **Audit logging**: Логирование действий пользователей

## 13. Планы развития

### 13.1 Краткосрочные цели
- Улучшение API документации (Swagger/OpenAPI)
- Расширение функциональности уведомлений
- Добавление метрик и мониторинга

### 13.2 Долгосрочные цели
- Микросервисная архитектура
- Интеграция с внешними системами
- Мобильное приложение

## 14. Контакты и поддержка

### 14.1 Команда разработки
- **Проект**: SpringProject1
- **Версия**: 0.0.1-SNAPSHOT
- **Статус**: В разработке

### 14.2 Документация
- **API Documentation**: В разработке
- **User Guide**: В разработке
- **Developer Guide**: В разработке

---

*Документация создана в соответствии с международными стандартами ISO для технической документации программного обеспечения.*
